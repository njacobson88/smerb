rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Participants collection - stores events per participant
    match /participants/{participantId} {
      // Allow read/write for now (test mode)
      // In production, restrict to authenticated users
      allow read, write: if true;

      // Events subcollection
      match /events/{eventId} {
        allow read, write: if true;
      }
    }

    // Sessions collection (optional top-level access)
    match /sessions/{sessionId} {
      allow read, write: if true;
    }

    // Valid participants collection - master list of valid IDs
    match /valid_participants/{participantId} {
      // Allow read to validate IDs, allow write to mark as in-use
      allow read, write: if true;
    }

    // Deny all other access by default
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
